'use strict';

{
  var $ = django.jQuery;

  var init = function init($element, options) {
    var settings = $.extend({
      ajax: {
        data: function data(params) {
          return {
            term: params.term,
            page: params.page,
            app_label: $element.data('app-label'),
            model_name: $element.data('model-name'),
            field_name: $element.data('field-name')
          };
        }
      }
    }, options);
    $element.select2(settings);
  };

  $.fn.djangoAdminSelect2 = function (options) {
    var settings = $.extend({}, options);
    $.each(this, function (i, element) {
      var $element = $(element);
      init($element, settings);
    });
    return this;
  };

  $(function () {
    // Initialize all autocomplete widgets except the one in the template
    // form used when a new formset is added.
    $('.admin-autocomplete').not('[name*=__prefix__]').djangoAdminSelect2();
  });
  $(document).on('formset:added', function () {
    return function (event, $newFormset) {
      return $newFormset.find('.admin-autocomplete').djangoAdminSelect2();
    };
  }(void 0));
}